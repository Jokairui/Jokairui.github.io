---
layout:     post
title:      为什么这些SQL语句逻辑相同，性能却差异巨大
subtitle:   什么时候索引会失效
date:       2019-08-05
author:     Khirye
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Mysql实战45讲读书笔记
---

#### 案例一

```mysql> select count(*) from tradelog where month(t_modified)=7;```

使用了函数操作之后，MySQL就不再走树搜索，也就使用不上索引了

为了用上索引，可以用一种取巧的方法

```sql
mysql> select count(*) from tradelog where
    -> (t_modified >= '2016-7-1' and t_modified<'2016-8-1') or
    -> (t_modified >= '2017-7-1' and t_modified<'2017-8-1') or 
    -> (t_modified >= '2018-7-1' and t_modified<'2018-8-1');
```

##### 优化器的偷懒行为

```select * from tradelog where i + 1 = 10000```

这样写MySQL也不能用上索引

